<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>pumumu's blog - Articles by pumumu</title>
  <meta name="author" content="pumumu">



  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="../favicon.png" rel="icon">
  <link href="../theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">
  <script src="../theme/js/modernizr-2.0.js"></script>
  <script src="../theme/js/ender.js"></script>
  <script src="../theme/js/octopress.js" type="text/javascript"></script>

  <link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="../">pumumu's blog</a></h1>
    <h2>fun to learn,learn for fun</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
<!--
  <li><a href="https://github.com/starp128">Me on Github</a></li>
-->
 <li><a href="https://github.com/starp128">Me on Github</a></li>


<!--
  <li><a href="www.pumumu.com/" rel="subscribe-rss">RSS</a></li>

-->


 
</ul>

<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:pumumu.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>








<ul class="main-navigation">

 <li><a href="/">home</a></li>

      <li><a href="../pages/about-me.html">about me</a></li>
      <li><a href="../pages/index.html">index</a></li>
    <!-- TODO: add categories here? -->
</ul></nav>
  <div id="main">
    <div id="content">
<div class="blog-index">
  		<article>
<header>
      <h1 class="entry-title">
        <a href="../ext2wen-jian-xi-tong-yuan-ma-fen-xi.html">ext2文件系统源码分析</a>
      </h1>
      <p class="meta"><time datetime="2014-02-22T00:00:00" pubdate>Sat 22 February 2014</time></p>
</header>

  <div class="entry-content"><p>本文基于linux1.2.13内核源码，分析ext2文件系统的实现，主要分析ext2文件系统的挂载、数据块block分配。</p>
<p><em>导读：</em></p>
<p><a href="#chapter1">一 ext2 概述</a></p>
<p><a href="#chapter2">二 ext2 映像结构</a></p>
<p><a href="#chapter3">三 ext2 mount过程</a></p>
<p><a href="#chapter4">四 ext2 数据块block的分配机制</a></p>
<p><a name="chapter1"></a></p>
<hr />
<h2>一、ext2 概述</h2>
<p>ext2是现在仍在广泛使用的一个文件系统，它对ext和minix进行了扩展和性能上的增强，上一篇文章<a href="./extwen-jian-xi-tong-yuan-ma-xue-xi-ji-si-kao.html">ext文件系统源码分析</a>中提到，文件系统的的核心就是分配和回收inode以及数据块block的方式。minix使用位图对整个块设备进行inode以及数据块block的分配和回收，ext文件系统使用链表对整个块设备进行inode以及数据块block的分配和回收，而ext2的方式更像是minix的方式1，但是又有较大的改进。</p>
<p>1 ext2将块设备的块分成<code>block_group</code>,每个组内都是按照位图的方式管理inode和数据块block。</p>
<p>2 数据块block的分配采用了预分配的机制。</p>
<p>使用这两个特点使得文件尽可能的分配在相邻的块上，同一个组内，这样可以减少平均寻道时间，提高IO效率。</p>
<p>ext2还有个特点就是在创建文件系统的时候可以根据预期的文件平均大小选择最佳的块大小，避免块的浪费。</p>
<p><a name="chapter2"></a></p>
<hr />
<h2>二、ext2 映像结构</h2>
<p><img alt="" src="./images/ext2_img.png" title="“ext2映像”" /></p>
<p>第一个是启动引导相关的，之后开始进行块的分组，每组的结构都是一样的 ...</p></div>
  <footer>
    <a rel="full-article" href="../ext2wen-jian-xi-tong-yuan-ma-fen-xi.html">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="../extwen-jian-xi-tong-yuan-ma-xue-xi-ji-si-kao.html">ext文件系统源码学习及思考</a>
      </h1>
      <p class="meta"><time datetime="2014-02-18T00:00:00" pubdate>Tue 18 February 2014</time></p>
</header>

  <div class="entry-content"><p>认识了linux管理文件系统的框架（也就是vfs）之后，再学习具体的文件系统就是比较容易的一件事了，下面记录了ext文件系统的学习过程，代码参考1.2.13的内核版本，这个内核版本比之现在3.x的版本可以说非常老了，但是早期版本内容注重具体实现，读起来容易很多，相信对以后继续深入学习会有很大帮助，至少现在版本的实现和早期版本的大体思想是一样的。</p>
<h2>本文导读：</h2>
<ul>
<li>ext文件系统简介及设计思想</li>
<li>ext文件系统磁盘映像X结构</li>
<li>ext文件系统的mount的过程</li>
<li>ext文件系统的io过程</li>
</ul>
<hr />
<h2>一 ext文件系统简介及设计思想</h2>
<h3>ext文件系统简介</h3>
<p>ext文件系统是第一个专门为linux内核打造的文件系统，但是现在基本已经不使用了，网上搜索原因大多是说它性能存在一些问题，我在看完源码之后也想不出任何原因，看来真是需要实践才能检验真理啊。</p>
<h3>ext设计思想</h3>
<p>文件系统要完成的功能就是管理文件，而文件就是<code>inode</code>和数据块block，不同的管理方式就形成了不同的文件系统，minix文件系统使用位图来分别管理<code>inode</code>和数据块block的分配和回收。而ext文件系统使用了链表来管理它们的分配和回收。这就是ext文件系统。可以说整个ext文件系统源码就是在实现用链表组织<code>inode</code>和数据块block。</p>
<hr />
<h2>二 ext文件系统磁盘映像结构</h2>
<p><img alt="" src="./images/ext_img.png" /></p>
<p>ext文件系统如图所示，第一个块是MBR块，第二个块是超级块，接下来是存放<code>inode</code>的区域，<code>inode ...</code></p></div>
  <footer>
    <a rel="full-article" href="../extwen-jian-xi-tong-yuan-ma-xue-xi-ji-si-kao.html">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="../minixwen-jian-xi-tong-xue-xi.html">minix文件系统学习</a>
      </h1>
      <p class="meta"><time datetime="2013-12-29T00:00:00" pubdate>Sun 29 December 2013</time></p>
</header>

  <div class="entry-content"><p>记录下学习过程，以便遗忘时可以顺着思路回忆起來。
<em>一切尽在源码中！！！</em></p>
<hr />
<p>深入学习minix文件系统是从linux的0.11内核版本开始的，更确切的说，把硬盘分区、文件系统、虚拟文件系统、网络文件系统等概念弄清楚也是在仔细阅读了内核源码才清晰的。还记得读明白0.11内核中minix源码以及之后的兴奋，以及之后阅读1.x版本内核中的ext，ext2和vfs等，每次读懂一些内容都会有种醒悟的感觉。</p>
<p>minix文件系统是源自minix操作系统的，linux0.11内核采用了这个现成的文件系统作为内核唯一支持的文件系统，当然在后续版本中就有了自己的ext等等其它文件系统。整个minix文件系统源码并不多。内容也非常精炼，非常适合开始学习文件系统。</p>
<p>0.11内核tree,非常精炼，这样让我们集中经历看核心代码。</p>
<p><img alt="" src="./images/linux_0_11_tree.png" title="“0.11内核tree”" /></p>
<p>0.11内核minix文件系统源码</p>
<p><img alt="" src="./images/linux_0_11_files.png" /></p>
<p>0.11版本内核还没有将虚拟文件系统VFS从实际的文件系统中抽象出来，因为那时就只有一种文件系统，到后来0.95版本的内核才将VFS分离出来，为各种文件系统共存提供了框架，后来Remy Card为linux内核写了第一个专门的文件系统ext文件系统，并加入到0.96版本的内核中。这都是90年代初的事情了。。。可惜我现在才整明白。
文件系统的建立是独立于系统初始化的，换句话说，文件系统是事先就建立好的。比如安装系统时候你会给一个硬盘分区，然后格式化为一个文件系统，系统引导后初始化，是读取这个文件系统并将其挂载在自己的跟<strong>’/’</strong>上。</p>
<hr />
<h2>一 ...</h2></div>
  <footer>
    <a rel="full-article" href="../minixwen-jian-xi-tong-xue-xi.html">Read On &crarr;</a>
  </footer>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="../qi-dian.html">起点</a>
      </h1>
      <p class="meta"><time datetime="2013-12-08T00:00:00" pubdate>Sun 08 December 2013</time></p>
</header>

  <div class="entry-content"><p>终于有了域名,可以动力十足的写博客了，这样的话既可以督促自己记录平时的工作学习，又能学习一些实际搭建网站方面的知识，建立这个博客主要都是从网上搜来教程然后一步步建立起来的，感谢大家乐于分享的精神，网页使用了pelican产生，而pelican又是使用了很多的优秀的开源工具。使用markdown标记语言可以近似于直接写纯文本一样，产生的页面非常简单漂亮。用来写博客在合适不过。</p>
<hr />
<p>参考资料</p>
<p><a href="https://github.com/getpelican/pelican">pelican on github</a></p>
<p><a href="http://docs.getpelican.com/">pelican document</a></p></div>
  <footer>
    <a rel="full-article" href="../qi-dian.html">Read On &crarr;</a>
  </footer>
  		</article>
<div class="pagination">

  <br />
</div></div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="../ext2wen-jian-xi-tong-yuan-ma-fen-xi.html">ext2文件系统源码分析</a>
      </li>
      <li class="post">
          <a href="../extwen-jian-xi-tong-yuan-ma-xue-xi-ji-si-kao.html">ext文件系统源码学习及思考</a>
      </li>
      <li class="post">
          <a href="../minixwen-jian-xi-tong-xue-xi.html">minix文件系统学习</a>
      </li>
      <li class="post">
          <a href="../qi-dian.html">起点</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="../category/filesystem.html">filesystem</a></li>
        <li><a href="../category/others.html">others</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
  </section>


    <section>
        <h1>Blogroll</h2>
        <ul>
            <li><a href="http://getpelican.com/" target="_blank">Pelican</a></li>
            <li><a href="http://jinja.pocoo.org/" target="_blank">Jinja2</a></li>
        </ul>
    </section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - pumumu -
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
</body>
</html>